<!DOCTYPE html><html lang="ru"><head><meta charset="UTF-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Spiiin's blog | Squirrel tips - 3</title><meta name="description" content=""><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=PT+Serif&amp;display=swap"><link rel="stylesheet" href="/css/highlights/darkula.css"><link rel="stylesheet" href="/css/main.css"><link rel="search" type="application/opensearchdescription+xml" href="http://spiiin.github.io/atom.xml" title="Spiiin's blog"><script>(function (i, s, o, g, r, a, m) {
  i['GoogleAnalyticsObject'] = r;
  i[r] = i[r] || function () {
    (i[r].q = i[r].q || []).push(arguments)
  }, i[r].l = 1 * new Date();
  a = s.createElement(o),
    m = s.getElementsByTagName(o)[0];
  a.async = 1;
  a.src = g;
  m.parentNode.insertBefore(a, m)
})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
ga('create', 'UA-00000000-0', 'auto');
ga('send', 'pageview');</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-shiki-plugin@latest/lib/codeblock.css">
<style>:root{--hl-color:#abb2bf;--hl-bg:#282c34;--hltools-bg:#21252b;--hltools-color:#bbbbbc;--hlnumber-bg:#282c34;--hlnumber-color:#495162;--hlscrollbar-bg:#373c47;--hlexpand-bg:linear-gradient(180deg,rgba(40,44,52,0.1),rgba(40,44,52,0.9))}</style><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="Spiiin's blog" type="application/atom+xml">
</head><body><div class="container"><header class="main-header"><h1 class="main-header__title uplize"><a class="main-header__title__link" href="/"><img class="header-image" src="/images/favicon.png" width="36" height="36">Spiiin's blog</a></h1><nav class="main-header__nav"><ul class="main-nav"><li class="main-nav__list"><a class="main-nav__list__link" href="/" target="_self">HOME</a></li><li class="main-nav__list"><a class="main-nav__list__link" href="/archives/" target="_self">ARCHIVE</a></li><li class="main-nav__list"><a class="main-nav__list__link" href="/tags/meta" target="_self">TAGS</a></li><li class="main-nav__list"><a class="main-nav__list__link" href="/blog/1" target="_self">ABOUT</a></li></ul></nav></header><main class="container__wrapper"><div class="pagination"><a class="pagination__link pagination__prev" href="/blog/64916/">Позже</a><a class="pagination__link pagination__next" href="/blog/5060/">Раньше</a></div><article class="article post"><h3 class="article__title">Squirrel tips - 3</h3><div class="article__date metadata"><div class="post-info">2009/09/16</div></div><div class="article__tags metadata">Tags:
<a class="article__tags__link metadata" href="/tags/squirell/">squirell</a></div><div class="article__body"><link rel="stylesheet" type="text&#x2F;css" href="https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css"><p><code>Squirrel</code> простой, как 5 копеек, язык. Но документации по нему очень мало. Официальный <a target="_blank" rel="noopener" href="http://squirrel-lang.org/doc/squirrel2.html">мануал</a>, и полупустые <a target="_blank" rel="noopener" href="http://wiki.squirrel-lang.org/default.aspx/SquirrelWiki/SquirrelWiki.html">вики</a> и <a target="_blank" rel="noopener" href="http://squirrel-lang.org/forums/default.aspx">форум</a> - все, что удалось найти (ну и исходный текст, если его считать за документацию). Поэтому я себе и пишу такие типсы о том, что не указано явно в доках.  </p>
<p>Есть вот в нем такой “спецэффект”, в принципе, логичный, но о котором следует помнить - если в классе имеется слот-значение, то инициализировать его можно прямо в теле класса, а не в конструкторе, все экземпляры получат копию этого слота. А если так сделать со слотом-ссылкой, то все экземпляры получат по копии этой ссылки, указывающей на один и тот же созданный объект. Поэтому слоты-ссылки стоит инициализировать в конструкторе. На примере:  </p>
<figure class="shiki js"><div class="codeblock"><div class="code"><pre class="shiki slack-dark"><code><span class="line"><span style="color: #569CD6">class</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">A</span><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #E6E6E6">{</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #9CDCFE">val</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">&quot;hello&quot;</span><span style="color: #E6E6E6">              </span><span style="color: #6A9955">//числа, строковые константы и члены перечислений - значения</span></span>
<span class="line"><span style="color: #E6E6E6">}</span></span>
<span class="line"><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #9CDCFE">a1</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">&lt;-</span><span style="color: #E6E6E6"> </span><span style="color: #DCDCAA">A</span><span style="color: #E6E6E6">()</span></span>
<span class="line"><span style="color: #9CDCFE">a2</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">&lt;-</span><span style="color: #E6E6E6"> </span><span style="color: #DCDCAA">A</span><span style="color: #E6E6E6">()</span></span>
<span class="line"><span style="color: #9CDCFE">a2</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">val</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">&quot; world!&quot;</span><span style="color: #E6E6E6">            </span><span style="color: #6A9955">//a2.val изменилось, a1.val не изменилось</span></span>
<span class="line"><span style="color: #DCDCAA">print</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">a1</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">val</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">+</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">a2</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">val</span><span style="color: #E6E6E6">);</span></span>
<span class="line"><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #569CD6">class</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">B</span></span>
<span class="line"><span style="color: #E6E6E6">{</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #9CDCFE">wrong</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> {</span><span style="color: #9CDCFE">val</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">&quot;hello&quot;</span><span style="color: #E6E6E6">}            </span><span style="color: #6A9955">// ссылочный тип, если создать здесь экземпляр таблицы, она будет &quot;шариться&quot; всеми экземплярами</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #9CDCFE">right</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">                       </span><span style="color: #6A9955">// не спешим создавать таблицу</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #569CD6">constructor</span><span style="color: #E6E6E6">()</span></span>
<span class="line"><span style="color: #E6E6E6">  {</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">right</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> {</span><span style="color: #9CDCFE">val</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">&quot;hello&quot;</span><span style="color: #E6E6E6">}          </span><span style="color: #6A9955">// создаем свою копию таблицы для каждого экземпляра класса</span></span>
<span class="line"><span style="color: #E6E6E6">  }</span></span>
<span class="line"><span style="color: #E6E6E6">}</span></span>
<span class="line"><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #9CDCFE">b1</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">&lt;-</span><span style="color: #E6E6E6"> </span><span style="color: #DCDCAA">B</span><span style="color: #E6E6E6">()</span></span>
<span class="line"><span style="color: #9CDCFE">b2</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">&lt;-</span><span style="color: #E6E6E6"> </span><span style="color: #DCDCAA">B</span><span style="color: #E6E6E6">()</span></span>
<span class="line"><span style="color: #DCDCAA">print</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">b1</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">wrong</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">==</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">b2</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">wrong</span><span style="color: #E6E6E6">)         </span><span style="color: #6A9955">//true,  ссылки указывают на одну и ту же таблицу</span></span>
<span class="line"><span style="color: #DCDCAA">print</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">b1</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">right</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">==</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">b2</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">right</span><span style="color: #E6E6E6">)         </span><span style="color: #6A9955">//false, у каждого объекта своя таблица</span></span>
<span class="line"><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #9CDCFE">b2</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">wrong</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">val</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">&quot; world!&quot;</span><span style="color: #E6E6E6">             </span><span style="color: #6A9955">//b1.wrong.val ссылается сюда же... </span></span>
<span class="line"><span style="color: #9CDCFE">b2</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">right</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">val</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">&quot; world!&quot;</span></span>
<span class="line"><span style="color: #DCDCAA">print</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">b1</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">wrong</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">val</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">+</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">b2</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">wrong</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">val</span><span style="color: #E6E6E6">)  </span><span style="color: #6A9955">//не вышло :(</span></span>
<span class="line"><span style="color: #DCDCAA">print</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">b1</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">right</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">val</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">+</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">b2</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">right</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">val</span><span style="color: #E6E6E6">)  </span><span style="color: #6A9955">//ура!</span></span>
<span class="line"><span style="color: #CE9178">```</span></span>
<span class="line"><span style="color: #CE9178">  </span></span>
<span class="line"></span>
<span class="line"><span style="color: #CE9178">Ну и еще штука, основанная на разнице между значениями и ссылками. Свободные переменные, переданные в функцию, вычисляются в момент определения функции. Т.е. если передать переменную-значение, то создастся ее копия и связи с исходной переменной не будет:  </span></span>
<span class="line"></span>
<span class="line"><span style="color: #CE9178">```</span><span style="color: #9CDCFE">js</span></span>
<span class="line"><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">a</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">&lt;-</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">10</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">function</span><span style="color: #E6E6E6"> </span><span style="color: #DCDCAA">f</span><span style="color: #E6E6E6"> () </span><span style="color: #D4D4D4">:</span><span style="color: #E6E6E6"> (</span><span style="color: #4EC9B0">a</span><span style="color: #E6E6E6">) { </span><span style="color: #DCDCAA">print</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">a</span><span style="color: #E6E6E6">) } </span><span style="color: #9CDCFE">a</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">5</span><span style="color: #E6E6E6"> </span><span style="color: #DCDCAA">f</span><span style="color: #E6E6E6">(); </span><span style="color: #6A9955">//выведет 10</span></span></code></pre></div></div></figure>
<p>Если все же нужно передать значение в функцию, можно завернуть его в класс или таблицу и воспользоваться одним из двух способов связи - передать таблицу как свободную переменную (как было описано выше) или привязать ее как окружение для функции. Второй способ основан на том, что функция когда встречает неизвестное ей имя переменной, она ищет его в таблице this. Эту таблицу можно заменить на свою, используя функцию bindenv. Разница между двумя способами заключается в том, что в первом случае ссылка на таблицу копируется в скрытую переменную, а во втором используется слабая ссылка на таблицу. Это означает, что во втором случае когда исходная таблица будет удалена, функция перестанет работать! На примере:  </p>
<figure class="shiki js"><div class="codeblock"><div class="code"><pre class="shiki slack-dark"><code><span class="line"><span style="color: #9CDCFE">t</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">&lt;-</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">a</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">&quot;vaaar!&quot;</span><span style="color: #E6E6E6"> }                           </span><span style="color: #6A9955">//кладем нужную переменную в таблицу</span></span>
<span class="line"><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #9CDCFE">f1</span><span style="color: #E6E6E6">  </span><span style="color: #D4D4D4">&lt;-</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">function</span><span style="color: #E6E6E6"> () </span><span style="color: #D4D4D4">:</span><span style="color: #E6E6E6"> (</span><span style="color: #4EC9B0">t</span><span style="color: #E6E6E6">)  { </span><span style="color: #DCDCAA">print</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">t</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">a</span><span style="color: #E6E6E6">) }   </span></span>
<span class="line"><span style="color: #9CDCFE">f2</span><span style="color: #E6E6E6">  </span><span style="color: #D4D4D4">&lt;-</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">function</span><span style="color: #E6E6E6"> () { </span><span style="color: #DCDCAA">print</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">a</span><span style="color: #E6E6E6">) }.</span><span style="color: #DCDCAA">bindenv</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">t</span><span style="color: #E6E6E6">)      </span><span style="color: #6A9955">//эта строка эквивалентна такой записи : function f2 ()  { print (a) }</span></span>
<span class="line"><span style="color: #E6E6E6">                                                </span><span style="color: #6A9955">//                                       f2 = f2.binenv(t)</span></span>
<span class="line"><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #DCDCAA">f1</span><span style="color: #E6E6E6">()                                            </span><span style="color: #6A9955">//vaaar!</span></span>
<span class="line"><span style="color: #DCDCAA">f2</span><span style="color: #E6E6E6">()                                            </span><span style="color: #6A9955">//vaaar!</span></span>
<span class="line"><span style="color: #9CDCFE">t</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">a</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">&quot;nyaaa!&quot;</span><span style="color: #E6E6E6">                                  </span><span style="color: #6A9955">//теперь попробуем так</span></span>
<span class="line"><span style="color: #DCDCAA">f1</span><span style="color: #E6E6E6">()                                            </span><span style="color: #6A9955">//nyaaa!</span></span>
<span class="line"><span style="color: #DCDCAA">f2</span><span style="color: #E6E6E6">()                                            </span><span style="color: #6A9955">//nyaaa!</span></span>
<span class="line"><span style="color: #569CD6">delete</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">t</span><span style="color: #E6E6E6">                                        </span><span style="color: #6A9955">//и вот так</span></span>
<span class="line"><span style="color: #DCDCAA">f1</span><span style="color: #E6E6E6">()                                            </span><span style="color: #6A9955">//nyaaa!</span></span>
<span class="line"><span style="color: #DCDCAA">f2</span><span style="color: #E6E6E6">()                                            </span><span style="color: #6A9955">//упс, сломалось, t больше не существует и f2 теперь ищет переменную a в глобальном пространстве имен</span></span></code></pre></div></div></figure>
<p>В <code>Squirrel</code>‘е для таблицы можно указать родителя, в котором будут искаться слоты, если их нету в самой таблице. Такой родитель будет называется делегатом. За счет этого таблицы становятся похожи на классы. Отличия состоят только в том, что таблицы нельзя инстанциировать, в них нельзя не будут работать метаметоды (но в таблицах-делегатах будут) и для них можно сменить делегата-родителя в любой момент. Еще я сильно пытался сделать что-то похожее на множественное наследование, которого в языке нету.  </p>
<figure class="shiki js"><div class="codeblock"><div class="code"><pre class="shiki slack-dark"><code><span class="line"><span style="color: #569CD6">class</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">A</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">a</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">1</span><span style="color: #E6E6E6"> }                             </span><span style="color: #6A9955">//классический способ определения для классов</span></span>
<span class="line"><span style="color: #9CDCFE">a</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">&lt;-</span><span style="color: #E6E6E6"> {</span><span style="color: #9CDCFE">a</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">1</span><span style="color: #E6E6E6">}                                  </span><span style="color: #6A9955">//и таблиц</span></span>
<span class="line"><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #9CDCFE">B</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">&lt;-</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">class</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">b</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">2</span><span style="color: #E6E6E6">}                           </span><span style="color: #6A9955">//синтаксический сахарок</span></span>
<span class="line"><span style="color: #9CDCFE">b</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">&lt;-</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">b</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">2</span><span style="color: #E6E6E6"> }</span></span>
<span class="line"><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #9CDCFE">C</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">&lt;-</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">class</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">extends</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">B</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">c</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">3</span><span style="color: #E6E6E6"> }                </span><span style="color: #6A9955">//наследование</span></span>
<span class="line"><span style="color: #9CDCFE">с</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">&lt;-</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">delegate</span><span style="color: #E6E6E6"> b : { </span><span style="color: #9CDCFE">c</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">3</span><span style="color: #E6E6E6"> }                   </span><span style="color: #6A9955">//и делегирование</span></span>
<span class="line"><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #9CDCFE">d</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">&lt;-</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">delegate</span><span style="color: #E6E6E6"> a : </span><span style="color: #9CDCFE">delegate</span><span style="color: #E6E6E6"> b :</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #9CDCFE">delegate</span><span style="color: #E6E6E6"> c : {</span><span style="color: #9CDCFE">d</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">4</span><span style="color: #E6E6E6">}                        </span><span style="color: #6A9955">//интерпретатор пропускает и такое, но настоящим делегатом будет только первый из списка, это видимо ошибка парсера</span></span>
<span class="line"><span style="color: #9CDCFE">E</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">&lt;-</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">class</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">extends</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">class</span><span style="color: #E6E6E6"> {</span><span style="color: #9CDCFE">e1</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">10</span><span style="color: #E6E6E6">}  {</span><span style="color: #9CDCFE">e2</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">11</span><span style="color: #E6E6E6">} </span><span style="color: #6A9955">//а вот подставить определение класса в том месте, где требуется его имя можно </span></span>
<span class="line"><span style="color: #9CDCFE">e</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">&lt;-</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">delegate</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">delegate</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">delegate</span><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #E6E6E6">     {</span><span style="color: #9CDCFE">z</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">3</span><span style="color: #E6E6E6"> } : a  : {</span><span style="color: #9CDCFE">x</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">1</span><span style="color: #E6E6E6">}  : {}            </span><span style="color: #6A9955">//и определить таблицу тоже - цепочки делегатов выглядят прикольно =(^_^)=</span></span></code></pre></div></div></figure>
<p>Можно, собственно вообще вместо наследования просто перекидывать в класс нужные слоты от какого-нибудь объекта, в том числе и задаваемого на лету, “<a target="_blank" rel="noopener" href="http://ru.wikipedia.org/wiki/Mixin">подмешивая</a>“ его свойства:  </p>
<figure class="shiki js"><div class="codeblock"><div class="code"><pre class="shiki slack-dark"><code><span class="line"><span style="color: #569CD6">function</span><span style="color: #E6E6E6"> </span><span style="color: #DCDCAA">mixin</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">clas</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">mix</span><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #E6E6E6">{</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #DCDCAA">foreach</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">slot</span><span style="color: #E6E6E6">,</span><span style="color: #9CDCFE">val</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">in</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">mix</span><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">clas</span><span style="color: #E6E6E6">[</span><span style="color: #9CDCFE">slot</span><span style="color: #E6E6E6">] </span><span style="color: #D4D4D4">&lt;-</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">val</span></span>
<span class="line"><span style="color: #E6E6E6">}</span></span>
<span class="line"><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #569CD6">class</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">A</span><span style="color: #E6E6E6"> {}</span></span>
<span class="line"><span style="color: #DCDCAA">mixin</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">A</span><span style="color: #E6E6E6"> , {</span><span style="color: #DCDCAA">f</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">function</span><span style="color: #E6E6E6">() </span><span style="color: #DCDCAA">print</span><span style="color: #E6E6E6"> (</span><span style="color: #CE9178">&quot;hello&quot;</span><span style="color: #E6E6E6">) } )</span></span>
<span class="line"><span style="color: #E6E6E6">A.f();   </span><span style="color: #6A9955">//print &quot;hello&quot;</span></span></code></pre></div></div></figure>
<p>Если еще отслеживать список имен добавленных методов, можно даже “отмешать” свойства обратно, единственное ограничение - делать это можно только до первого создания экземпляра класса, зато таблицы можно модифицировать как душе угодно.</p>

<div id="gitalk-container"></div>
<script src="https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js"></script><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"><script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

		<script>
		var gitalkConfig = {"clientID":"Ov23liG1mZbiQOIdi91X","clientSecret":"e05812685eb741a752982b89dcf6f5b58dc10251","repo":"spiiin.github.io","owner":"spiiin","admin":["spiiin"],"distractionFreeMode":false};
	    gitalkConfig.id = md5(location.pathname);
		var gitalk = new Gitalk(gitalkConfig);
	    gitalk.render("gitalk-container");
	    </script><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script></div></article><div class="pagination"><a class="pagination__link pagination__prev" href="/blog/64916/">Позже</a><a class="pagination__link pagination__next" href="/blog/5060/">Раньше</a></div></main><footer class="footer metadata"><p class="footer__text">© 2024 spiiin</p><p class="footer__text">Powered by <a class="footer__text__link" href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a class="footer__text__link" href="https://pages.github.com/" target="_blank">Github Page</a></p></footer></div><!-- hexo injector body_end start -->
  <script>
  const CODE_CONFIG = {
    beautify: undefined,
    highlightCopy: undefined,
    highlightLang: undefined,
    highlightHeightLimit: undefined,
    isHighlightShrink: undefined,
    copy: {
      success: 'undefined',
      error: 'undefined',
      noSupport: 'undefined',
    }
  };
  console.log(
    `%c hexo-shiki-plugin %c v1.0.27 %c https://github.com/nova1751/hexo-shiki-plugin`,
    "color: #fff; background: #5f5f5f",
    "color: #fff; background: #80c8f8",
    ""
  );
  </script>
  <!-- hexo injector body_end end --></body></html>