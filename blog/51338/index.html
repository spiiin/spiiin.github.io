<!DOCTYPE html><html lang="ru"><head><meta charset="UTF-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Spiiin's blog | 1500 Archers on a 28.8 Kbps</title><meta name="description" content=""><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=PT+Serif&amp;display=swap"><link rel="stylesheet" href="/css/highlights/darkula.css"><link rel="stylesheet" href="/css/main.css"><link rel="search" type="application/opensearchdescription+xml" href="http://spiiin.github.io/atom.xml" title="Spiiin's blog"><script>(function (i, s, o, g, r, a, m) {
  i['GoogleAnalyticsObject'] = r;
  i[r] = i[r] || function () {
    (i[r].q = i[r].q || []).push(arguments)
  }, i[r].l = 1 * new Date();
  a = s.createElement(o),
    m = s.getElementsByTagName(o)[0];
  a.async = 1;
  a.src = g;
  m.parentNode.insertBefore(a, m)
})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
ga('create', 'UA-00000000-0', 'auto');
ga('send', 'pageview');</script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Spiiin's blog" type="application/atom+xml">
</head><body><div class="container"><header class="main-header"><h1 class="main-header__title uplize"><a class="main-header__title__link" href="/"><img class="header-image" src="/images/favicon.png" width="36" height="36">Spiiin's blog</a></h1><nav class="main-header__nav"><ul class="main-nav"><li class="main-nav__list"><a class="main-nav__list__link" href="/" target="_self">HOME</a></li><li class="main-nav__list"><a class="main-nav__list__link" href="/archives/" target="_self">ARCHIVE</a></li><li class="main-nav__list"><a class="main-nav__list__link" href="/tags/meta" target="_self">TAGS</a></li><li class="main-nav__list"><a class="main-nav__list__link" href="/blog/1" target="_self">ABOUT</a></li></ul></nav></header><main class="container__wrapper"><article class="article post"><h3 class="article__title">1500 Archers on a 28.8 Kbps</h3><div class="article__date metadata"><div class="post-info">2011/07/27</div></div><div class="article__tags metadata">Tags:
<a class="article__tags__link metadata" href="/tags/dev/">dev</a></div><div class="article__body"><link rel="stylesheet" type="text&#x2F;css" href="https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css"><p><a href="http://www.gamasutra.com/view/feature/3094/1500_archers_on_a_288_network_.php" target="_blank" rel="noopener">http://www.gamasutra.com/view/feature/3094/1500_archers_on_a_288_network_.php</a> Статья о реализации сетевой игры в Age of Empires. Алгоритм подходит для всех сетевых игр. Основная идея – чтобы не ждать сообщений от всех игроков каждый ход, нужно реагировать на них с задержкой в 2 условных тика. То есть ставим себе нулевой ход, всем соперникам минус первый, собираем все события текущего хода, записываем их во очередь событий второго хода и отправляем в сеть, в то же время собирая сообщения соперников и записывая их в очередь либо для следующего хода, либо для следующего через один, в зависимости от того, кто быстрее отработал текущий ход. <img src="http://www.gamasutra.com/features/20010322/terrano_01.jpg" alt=""> Для быстрых клиентов за ход отрисовывается несколько кадров, для медленных – один. Если приходится долго стоять, ожидая одного или нескольких игроков, отстающих более чем на ход, остальные, пока ждут сообщений от отстающих, делают свой ход дольше, тогда для всех сообщений от быстрых игроков за этот ход необходимо ужать время в стандартный диапазон тика (их события произойдут “раньше”, чем от тех, кто лагает). При переходе на следующий ход все принятые сообщения из позапрошлого хода сортируются по времени их наступления и ход “проигрывается”, то есть сообщение выбирается из очереди только в ту фазу хода, когда оно должно произойти. Время тика где-то 50-200 миллисекунд. Получается довольно риалтаймово.</p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script></div></article><section class="comments"><div id="disqus_thread"></div><script>var disqus_shortname = 'spiiin-github-io';
(function () {
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async></script></section><div class="pagination"><a class="pagination__link pagination__prev" href="/blog/49345/">Next</a><a class="pagination__link pagination__next" href="/blog/43611/">Back</a></div></main><footer class="footer metadata"><p class="footer__text">© 2022 spiiin</p><p class="footer__text">Powered by <a class="footer__text__link" href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a class="footer__text__link" href="https://pages.github.com/" target="_blank">Github Page</a></p></footer></div></body></html>