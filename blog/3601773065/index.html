<!DOCTYPE html><html lang="ru"><head><meta charset="UTF-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Spiiin's blog | Рандомные мысли про код, дизайн, C++ и геймдев</title><meta name="description" content=""><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=PT+Serif&amp;display=swap"><link rel="stylesheet" href="/css/highlights/darkula.css"><link rel="stylesheet" href="/css/main.css"><link rel="search" type="application/opensearchdescription+xml" href="http://spiiin.github.io/atom.xml" title="Spiiin's blog"><script>(function (i, s, o, g, r, a, m) {
  i['GoogleAnalyticsObject'] = r;
  i[r] = i[r] || function () {
    (i[r].q = i[r].q || []).push(arguments)
  }, i[r].l = 1 * new Date();
  a = s.createElement(o),
    m = s.getElementsByTagName(o)[0];
  a.async = 1;
  a.src = g;
  m.parentNode.insertBefore(a, m)
})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
ga('create', 'UA-00000000-0', 'auto');
ga('send', 'pageview');</script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Spiiin's blog" type="application/atom+xml">
</head><body><div class="container"><header class="main-header"><h1 class="main-header__title uplize"><a class="main-header__title__link" href="/"><img class="header-image" src="/images/favicon.png" width="36" height="36">Spiiin's blog</a></h1><nav class="main-header__nav"><ul class="main-nav"><li class="main-nav__list"><a class="main-nav__list__link" href="/" target="_self">HOME</a></li><li class="main-nav__list"><a class="main-nav__list__link" href="/archives/" target="_self">ARCHIVE</a></li><li class="main-nav__list"><a class="main-nav__list__link" href="/tags/meta" target="_self">TAGS</a></li><li class="main-nav__list"><a class="main-nav__list__link" href="/blog/1" target="_self">ABOUT</a></li></ul></nav></header><main class="container__wrapper"><div class="pagination"><a class="pagination__link pagination__prev" href="/blog/3139044644/">Позже</a><a class="pagination__link pagination__next" href="/blog/1495987502/">Раньше</a></div><article class="article post"><h3 class="article__title">Рандомные мысли про код, дизайн, C++ и геймдев</h3><div class="article__date metadata"><div class="post-info">2024/05/20</div></div><div class="article__tags metadata">Tags:
<a class="article__tags__link metadata" href="/tags/cpp/">cpp</a><a class="article__tags__link metadata" href="/tags/dev-method/">dev_method</a><a class="article__tags__link metadata" href="/tags/gamedev/">gamedev</a></div><div class="article__body"><link rel="stylesheet" type="text&#x2F;css" href="https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css"><ul>
<li><a href="/blog/1728194429/" title="С++ в геймдеве">С++ в геймдеве</a> — предыдущий пост на похожую тему</li>
</ul>
<p>Несколько общих статей от разработчиков игр:<br>[1] - <a href="https://loglog.games/blog/leaving-rust-gamedev/" target="_blank" rel="noopener">Leaving Rust gamedev after 3 years</a> — про то, что фичи Rust-а не особо помогают для геймдева, а периодически и мешают.<br>[2] - <a href="https://www.elopezr.com/life-and-death-of-a-graphics-programmer/" target="_blank" rel="noopener">Life and Death of a Graphics Programmer</a> — взгляд на геймдев со стороны графического разработчика. Достаточно высокий, чтобы быть интересным любому разработчику игр.</p>
<p>Важные моменты из статей:</p>
<blockquote>
<p>Generalized systems don’t lead to fun gameplay</p>
</blockquote>
<p>Программирование геймплея практически невозможно уложить в обобщенную систему или библиотеку на С++/Rust (как и иерархию классов), нужны другие строительные блоки.</p>
<blockquote>
<p>Making a fun &amp; interesting games is about rapid prototyping and iteration, Rust’s values are everything but that</p>
</blockquote>
<p>Строгие требования языка мешают прототипированию. Геймдев — не про выражение строгих требований, а про простые эксперименты и быстрые итерации.</p>
<blockquote>
<p>Rust gamedev ecosystem lives on hype</p>
</blockquote>
<p>Больше даже не про Rust, а про open-source библиотеки в принципе. Большая часть из них не готова к использованию в продакшене. Код в продакшене сильно сложнее за счёт того, что в нём заложено решения множества возникавших проблем.</p>
<blockquote>
<p>Упорная борьба с компилятором за то, чтобы заставить его сделать что-то конкретное, даёт чувство достижения. В одной кодовой базе была мощная функция рефлексии шейдеров с множеством метахакерских шаблонов и макросов, которая работала, если оставить ее в покое, но ее было невероятно сложно отлаживать, изменять и расширять. Оглядываясь назад, можно сказать, что такая альтернатива, как генерация кода, могла бы работать лучше.</p>
</blockquote>
<p>Касается и других систем рефлексии.</p>
<blockquote>
<p>Как графический программист я добавлял бесконечное количество чекбоксов, слайдеров и кнопок для множества редакторов объектов. И намного более важно в этом, чтобы элемент был добавлен в корректную категорию, имел правильные ограничения на ввод и понятные подсказки, что то, как выглядит код, это абсолютно неинтересно и неважно артисту.</p>
</blockquote>
<p>Как и с любыми тулзами. Невозмжно, что под капотом, важно что тот, как работает с программой (фактически, ДЕЛАЕТ игру) имел то, что удобно для него. Программисты типично пытаются делать тулзы для себя, а не для других. Один из симптомов такого перекоса — желание выбрать/создать скриптовый язык, похожий на C++.</p>
<h2 id="Проектирование-под-команду"><a href="#Проектирование-под-команду" class="headerlink" title="Проектирование под команду"></a>Проектирование под команду</h2><p>Проектирование (в частности, выбор языка и инфраструктуры) в геймдеве сильно зависит состава команды. В [2] есть сравнение команд, в которых шейдеры могут трогать только программисты с теми, в которых к ним есть доступ у технических артистов, и просто артистов. Если в Doom шейдеры модифицируют только программисты, то в нём и будет около 100 типов шейдеров (и не будет серьёзного инструмента для работы с ними), тогда как в Unreal вышедшие проекты могут содержать до 10к материалов, но и тулзы, в которых делаются шейдеры, будет выглядеть сильно по разному.</p>
<p><strong>Если игру делают программисты, и хотят сделать редактор, важно понимать для кого они делают редактор — для себя или будущих гейм-дизайнеров, со старта.</strong></p>
<ul>
<li><a href="/blog/2721099263/" title="Ещё о проектировании (движки и история)">Ещё о проектировании (движки и история)</a> — одна из больших идей этой статьи, что проектирование (не только тулзов, но и архитектуры) изначально должно учитывать конфигурацию команды.</li>
</ul>
<h2 id="Геймдев-проблематика"><a href="#Геймдев-проблематика" class="headerlink" title="Геймдев проблематика"></a>Геймдев проблематика</h2><p><a href="https://www.youtube.com/watch?v=o5K0uqhxgsE" target="_blank" rel="noopener">This Problem Changes Your Perspective On Game Dev</a> — обзор процесса поиска в дизайне. Критична простота экспериментов, и скорость итерации. В видео нет никаких новых идей — это стандартные требования геймдизайнеров к инструментам, чтобы иметь возможность создавать интересный геймплей. Причём не только к инди или инновационным играм, а вообще к играм любого жанра.</p>
<p><a href="[https://www.youtube.com/watch?v=72y2EC5fkcE">Tomorrow Corporation Tech Demo</a> — небольшой пример хот-релоада<br><a href="https://www.youtube.com/watch?v=PUv66718DII" target="_blank" rel="noopener">Inventing on Principle</a> — еще пример<br><a href="https://youtu.be/-zc8LcDwVUc?si=1RkL-OX3RNfc6gk_&amp;t=132" target="_blank" rel="noopener">NimForUE 101: uStructs</a> — перезагрузка в vm unreal с помощью кода на nim</p>
<ul>
<li><a href="/blog/3309518526/" title="Системы поиска сокровищ">Системы поиска сокровищ</a> — системы поиска сокровищ в песочницах</li>
</ul>
<p>В общем, необходимо:<br><code>- возможность очень быстро проверить изменения</code> — быстрая сборка, в том числе с возможностью хот-релоада<br><code>- простая интроспекция</code> — в том числе визуальная, через редакторы и дополнительный gui<br><code>- возможность комбинировать объекты</code>. Особенность геймдева — наличие большого числа объектов, которые могут изменять поведение динамически.</p>
<p>Дополнительно, так как геймдев требователен к производительности:<br><code>- возможность оптимизации быстро написанного кода</code> — Just-in-Time, Ahead-of-Time</p>
<h2 id="Про-волны-развития-технологий"><a href="#Про-волны-развития-технологий" class="headerlink" title="Про волны развития технологий"></a>Про волны развития технологий</h2><p>C++ находится на достаточно поздней стадии развития — много лет использования, развитые компиляторы с оптимизациями, стандартная библиотека. Периодически предлагаются языки-наследники (Carbon, Cpp2, Val). Но при этом он плохо подходит для решения специфичный для современного геймдизайна проблем, перечисленных выше.</p>
<p><code>- долгая компиляция</code>. Заменить include на модули стоило бы лет 15 назад. Тем не менее, модули все ещё не используются.<br><code>- рефлексия в стадии &quot;обсуждаем, как стандартизовать&quot;</code>. Из-за особенностей C++ можно ждать возможности использовать то что настандартизируют ещё очень долго. Причём только рефлексию, без кодогенерации и полноценного compile-time выполнения, которые тоже нужны. Лучшее решение сейчас — внешний инструмент.<br><code>- менять код на лету можно очень ограниченно</code>. Интерпретации не планируется, hot-reload на уровне подмены динамической библиотеки (доступной не на всех платформах). Требуется внешнее решение.</p>
<p><em>Вообще ждать появления чего-то в стандарте — очень ненадёжно. Может быть отложено, принято криво, после принятия еще несколько лет до исправления багов во всех реализацией, и еще — на обновление библиотек</em></p>
<p>Как сделать разработку легче? </p>
<p><strong>Не пытаться использовать C++ там, где это неудобно, использовать другой язык или языки для описания игровой логики</strong>. Такой на котором проще решать проблемы гейм-дизайнеров, не программистов (этот язык даже скорее всего будет <em>менее</em> удобен программистам, во всяком случае вначале).</p>
<p><img src="/blog/3601773065/lobster_small.png" alt=""><br><em>что-то типа <a href="https://enginearchitecture.org/downloads/reac2023_scripting_language.pdf" target="_blank" rel="noopener">такого</a> (доклад сам по себе про похожие идеи). автор языка lobster, также flatbuffers и программист в нескольких AAA-проектах</em></p>
<p><a href="https://grimfandango.network/features/articles/lua-in-grim-fandango" target="_blank" rel="noopener">Lua in Grim Fandango</a> — история <a href="https://www.lua.org/doc/hopl.pdf" target="_blank" rel="noopener">первого</a> использования lua в качестве скриптового языка.</p>
<p>Телефоны/консоли также на поздней фазе развития — запаса мощности часто хватает для того, чтобы запихнуть “дорогие” абстракции, увеличивающие как время компиляции, так и время выполнения кода. Для казуальных и прочих “простых” игр — раз в 5-10. Т.е. в принципе можно вообще использовать в 5-10 раз более медленный язык для реализации всей логики, ради того, чтобы сделать удобнее гейм-дизайнерам.</p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script></div></article><div class="pagination"><a class="pagination__link pagination__prev" href="/blog/3139044644/">Позже</a><a class="pagination__link pagination__next" href="/blog/1495987502/">Раньше</a></div></main><footer class="footer metadata"><p class="footer__text">© 2024 spiiin</p><p class="footer__text">Powered by <a class="footer__text__link" href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a class="footer__text__link" href="https://pages.github.com/" target="_blank">Github Page</a></p></footer></div></body></html>